/**
 * @file Firestore Security Rules
 * @description This ruleset allows any signed-in user full access to all data. This is for prototyping only and is NOT suitable for production.
 * @dataStructure
 *   - /artifacts/{appId}/users/{userId}: Stores user information.
 *   - /artifacts/{appId}/users/{userId}/transactions/{transactionId}: Stores financial transactions for a specific user.
 * @keySecurityDecisions All authenticated users have full access to all data.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows any authenticated user to read, create, update, and delete user data.
     * @path /artifacts/{appId}/users/{userId}
     * @allow (create) - Any signed-in user can create a user document.
     * @allow (get) - Any signed-in user can read any user document.
     * @allow (update) - Any signed-in user can update any user document.
     * @allow (delete) - Any signed-in user can delete any user document.
     * @deny (none) - No requests are denied.
     * @principle Allows all authenticated users full access.
     */
    match /artifacts/{appId}/users/{userId} {
      allow get, list, create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows any authenticated user to read, create, update, and delete transaction data.
     * @path /artifacts/{appId}/users/{userId}/transactions/{transactionId}
     * @allow (create) - Any signed-in user can create a transaction document.
     * @allow (get) - Any signed-in user can read any transaction document.
     * @allow (update) - Any signed-in user can update any transaction document.
     * @allow (delete) - Any signed-in user can delete any transaction document.
     * @deny (none) - No requests are denied.
     * @principle Allows all authenticated users full access.
     */
    match /artifacts/{appId}/users/{userId}/transactions/{transactionId} {
      allow get, list, create, update, delete: if isSignedIn();
    }

    function isSignedIn() {
      return request.auth != null;
    }
  }
}